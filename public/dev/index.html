<!doctype html>
<html>
	<head>

		<!-- allows responsive web design -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>Dewey | Explore Where Your Friends Have Been </title>

		<link rel="stylesheet" type="text/css" href="/assets/bootstrap.css"/>
		<link rel="stylesheet" type="text/css" href="/assets/dewey.css"/>

	</head>
	<body data-ng-app="DeweyApp">
		<div id="fb-root"></div>

		<!-- required for facebook login -->
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=1387319571552620";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>

		<!-- container; updates with angular routes -->
		<div data-ng-view></div>

		<!-- logout template -->
		<script type="text/ng-template" id="/logout">

			<div id="main-view">
				<div ng-include src="'/topBar'"></div>
				<div ng-include src="'/leftBar'">
	  			<div class="col-xs-12"> 
				    <div class="login col-xs-12">
				    	<img id="logo" class="col-xs-12" src="/assets/logo_transparent.png">
				    	<br>
				    	<span class="mission col-xs-12">explore where your friends have been</span>
				    	<br>
				    </div>
	        </div>
				</div>
				<div ng-include src="'/dataViz'"></div>
		</script>

		<script type="text/ng-template" id="/login">
			<div id="main-view">
				<div ng-include src="'/topBar'"></div>
				<div ng-include src="'/leftBar'">
	  			<div class="col-xs-12"> 
				    <div class="login col-xs-12">
				    	<img id="logo" class="col-xs-12" src="/assets/logo_transparent.png">
				    	<br>
				    	<span class="mission col-xs-12">explore where your friends have been</span>
	            <button ng-show="facebookLoginButton" ng-click="facebookLogin()" class="btn btn-default btn-lg col-xs-12">
	            	login with facebook
	            </button>

	            <!-- only exists to allow a way to log out of facebook -->
	            <button ng-show="facebookLoginButton" class="btn btn-default btn-lg col-xs-12">
	      				<div class="fb-login-button" data-max-rows="1" data-size="large" data-show-faces="true" data-auto-logout-link="true"></div>
	            </button>
						</div>
	        </div>
				</div>
				<div ng-include src="'/dataViz'"></div>
			</div>
		</script>

		<script type="text/ng-template" id="/topBar">
			<div id="top-bar">topbar</div>
		</script>

		<script type="text/ng-template" id="/leftBar">
			<div id="left-bar">leftbar</div>
		</script>

		<script type="text/ng-template" id="/dataViz">
			<div id="data-viz">dataviz</div>
		</script>

		<script type="text/ng-template" id="/login">
			<div id="main-view">
				<div id="top-bar"></div>
				<div id="left-bar">
					<div id="login" class="col-xs-12">
						<img id="logo" class="col-xs-12" src="/assets/logo_transparent.png">
						<br>
						<span class="mission col-xs-12">explore company expertise</span>
						<br>
						<input type="email" class="form-control" id="email" name="email" placeholder="email" ng-model="loginData.email">
						<input type="password" class="form-control" id="password" name="password" placeholder="password" ng-model="loginData.password">
						<button type="button" class="col-xs-12 btn btn-default btn-lg" ng-click='login()'>login</button>
						<div class="col-xs-1"></div>
					</div>
				</div>
				<div id="data-viz"></div>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/search">
			<div id="main-view">
				<div id="top-bar"></div>
				<div id="left-bar">
					<div id="search">
						<div ng-include src="'/navigation'"></div>
						<div ng-include src="'/searchResults'"></div>
					</div>
				</div>
				<div id="data-viz"></div>
			</div>
		</script>

		<script type="text/ng-template" id="/navigation">
			<nav id="nav" class="col-xs-12">
				<a href="#/search">
					<img id="logo" src="/assets/logo.png">
				</a>
				<div id="search" class="input-group input-group-lg">
				  <input type="text" class="form-control" placeholder="search" ng-keyup="search()" ng-model="queryData.query">
				</div>
			</nav>
		</script>

		<script type="text/ng-template" id="/searchResults">
			<div id="list" class="col-xs-12 list-group">
				<div ng-repeat="result in searchResults | limitTo: 8" class="list-group-item">
				  <a href="#/{{ result.category }}/{{ result.id }}">
						<div class="circular-image" style="background-image:url('/assets/{{ result.image }}')"></div>
				  	<div class="result-text-container">
					    <h4 class="list-group-item-heading">{{ result.name }}</h4>
					    <p class="list-group-item-text">{{ result.description }}</p>
				  	</div>
				  </a>
				</div>
				<a href="" class="action-link">view all</a>
			</div>
		</script>

		<script type="text/ng-template" id="/user">
			<div id="main-view">
				<div id="top-bar"></div>
				<div id="left-bar">
					<div ng-include src="'/navigation'"></div>
					<div ng-include src="'/userProfile'"></div>
					<div ng-include src="'/topicsForUser'"></div>
					<div ng-include src="'/groups'"></div>
				</div>
				<div id="data-viz">
					<div ng-include src="'/graph'"></div>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/userProfile">
			<div id="profile" class="col-xs-12">
				<div class="circular-image" style="background-image:url('/assets/{{ user.image }}')"></div>
				<div id="information" class="col-xs-12">
					<span class="name">{{ user.first_name }} {{ user.last_name }}</span>
					<span class="description">{{ user.position }}</span>
					<span class="email">{{ user.email }}</span>
					<span class="phone">{{ user.phone }}</span>
				</div>
				<a href="#/users/{{ user.id }}/edit" class="action-link">edit profile</a>
			</div>
		</script>

		<script type="text/ng-template" id="/topicsForUser">

			<!--
			<div id="tags" class="col-xs-12">
        <span class="tag" ng-repeat="topic in topicsForUser | limitTo: 8">
          <a href="#/topics/{{ topic.id }}">{{ topic.title }}</a>
          <!--
          <span ng-click="removeTopicFromUser($event, topic.id)" class="glyphicon glyphicon-remove"></span>
          -->
        </span>
        <!--
        <input id="typeahead" type="text"  ng-model="selectedTopic" placeholder="Add expertise" typeahead-on-select="addTopicToUser($item)" typeahead="topic as topic.title for topic in topic_choices | filter: $viewValue | limitTo: 8"/>
        -->
			</div>
			<a href="" class="action-link">view all</a>
		</script>

		<script type="text/ng-template" id="/groups">
			<div id="groups" class="col-xs-12">
				<h3>GROUPS</h3>
				<!--
				<div id="list" class="col-xs-12 list-group">
					<div ng-repeat="group in groups" class="list-group-item">
					  <a href="#/group/{{ group.id }}">
							<div class="circular-image" style="background-image:url('/assets/{{ group.image }}')"></div>
					  	<div class="list-text-container">
						    <h4 class="list-group-item-heading">{{ group.name }}</h4>
						    <p class="list-group-item-text">{{ group.description }}</p>
					  	</div>
					  </a>
					</div>
				</div>
				-->
				<a href="#/users/{{ user.id }}/groups/create" class="action-link">create a new group</a>
				<a href="#/users/{{ user.id }}/notifications" class="action-link">view notifications</a>
			</div>
			-->

			<div id="tags" class="col-xs-12">
        <span ng-show="current_user_id == user.id">Have You Been To:</span>
        <span ng-show="current_user_id != user.id">Has {{user.first_name}} Been To:</span>
        <span class="tag" ng-repeat="topic in topicSuggestions">
          <a href="#/topics/{{ topic.id }}">{{ topic.title }}</a>
          <span ng-click="addTopicSuggestionToUser(topic, $topic)" class="glyphicon glyphicon-check"></span>
        </span>

        <input id="typeahead" type="text"  ng-model="selectedTopic" placeholder="Add places" typeahead-on-select="addTopicToUser($item)" typeahead="topic as topic.title for topic in topicChoices | filter: $viewValue | limitTo: 8"/>
			</div>

			<div id="tags" class="col-xs-12">
        <span ng-show="current_user_id == user.id">Places You've Been To:</span>
        <span ng-show="current_user_id != user.id">Places {{user.first_name}}'s Been To:</span>
        <span class="tag" ng-repeat="topic in topicsForUser">
          <a href="#/topics/{{ topic.id }}">{{ topic.title }}</a>
          <span ng-click="removeTopicFromUser($event, topic.id)" class="glyphicon glyphicon-remove"></span>
        </span>
      </div>

		</script>

		<script type="text/ng-template" id="/topic">
			<div id="main-view">
				<div id="top-bar">
					<div id="filters-container">
						<div class="dropdown">
							<button class="btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">Location</button>
							  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
							    <li role="presentation"><a role="menuitem" tabindex="-1" href="">Stanford, CA</a></li>
							    <li role="presentation"><a role="menuitem" tabindex="-1" href="">Berkeley, CA</a></li>
							    <li role="presentation"><a role="menuitem" tabindex="-1" href="">San Francisco, CA</a></li>
							    <li role="presentation"><a role="menuitem" tabindex="-1" href="">San Jose, CA</a></li>
							  </ul>
						  </button>
						</div>
					</div>
				</div>
				<div id="left-bar">
					<div ng-include src="'/navigation'"></div>
					<div ng-include src="'/topicProfile'"></div>
					<div ng-include src="'/usersForTopic'"></div>
					<div ng-include src="'/userSuggestionsForTopic'"></div>
				</div>
				<div id="data-viz">
					<div ng-include src="'/graph'"></div>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/topicProfile">
			<div id="profile" class="col-xs-12">
				<div class="circular-image" style="background-image:url('{{ topic.freebase_image_url }}')"></div>
				<div id="information" class="col-xs-12">
					<span class="name">{{ topic.title }}</span> 
					<br>
					<span class="description">{{ topic.description }}</span>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/usersForTopic">
			<div id="list" class="col-xs-12 list-group">

				<div ng-repeat="user in usersForTopic | limitTo: 5" class="list-group-item">
				  <a href="#/{{ user.category }}/{{ user.id }}">
						<div class="circular-image" style="background-image:url('/assets/{{ user.image }}')"></div>
				  	<div class="user-text-container">
					    <h4 class="list-group-item-heading">{{ user.name }}</h4>
				  	</div>
				  </a>
				  <!--
				  <div class="col-xs-2" style="position: absolute; right: 10px;top: 20px;">
            <span ng-click="removeUserFromTopic($event, user.id)" class="glyphicon glyphicon-remove"></span>
          </div>
          -->
				</div>
      </div>

    </script>

    <script type="text/ng-template" id="/userSuggestionsForTopic">

			<div class="list col-xs-12 list-group">
        <h4>Have Your Friends Been to {{ topic.title }}?</h4>
				<div ng-repeat="user in userSuggestions" class="list-group-item">
				  <a href="#/{{ user.category }}/{{ user.id }}">
						<div class="circular-image" style="background-image:url('{{ user.image_url }}')"></div>
				  	<div class="col-xs-10 user-text-container">
					    <h4 class="list-group-item-heading">{{ user.first_name }} {{ user.last_name }}</h4>
				  	</div>
				  </a>

				  <div class="col-xs-2" style="position: absolute; right: 10px;top: 20px;">
            <span ng-click="addUserSuggestionToTopic(user, $index)" class="glyphicon glyphicon-check"></span>
          </div>
        </div>

				<a href="" class="action-link">view all</a>
				
				<!--
        <div ng-if="shouldShowAddUserToTopic">
          <div class="list-group-item">
					  <div class="circular-image" style="background-image:url('/assets/plus.png')"></div>
					  <div class="col-xs-10 result-text-container">
              <input id="typeahead" type="text" class=" form-control" ng-model="selectedUser" placeholder="Add user" typeahead-on-select="addUserToTopic($item)" typeahead="user as user.first_name + ' ' + user.last_name for user in userChoices | filter: $viewValue | limitTo: 8"/>
					  </div>
          </div>
        </div>
        -->

			<div class="list col-xs-12 list-group">
        <h4>Add a Destination in  {{ topic.title }}?</h4>

        		<div class="list-group-item">
        		<div class="circular-image" style="background-image:url('/assets/plus.png')"></div>
        							  <div class="col-xs-10 result-text-container">


			<input id="new-topic" type="text" class="form-control" placeholder="Add a destination" ng-keyup="addSubtopicToTopic()" ng-model="newTopic.title" />
			</div>
		</div>
</div>

			</div>
		</script>

		<!-- visualization directive -->
		<script type="text/ng-template" id="/graph">
			<div ng-controller="GraphController">
				<svg ng-attr-width="100%" ng-attr-height="100%">
					<g class="graph-container">
						<g class="links">
							<g ng-repeat="link in graphLinks">
							 	<line
			            class="link"
			            ng-attr-stroke-width="27"
			            ng-attr-x1="{{ link.source.x }}"
			            ng-attr-y1="{{ link.source.y }}"
			            ng-attr-x2="{{ link.target.x }}"
			            ng-attr-y2="{{ link.target.y }}"
			            position="absolute"
			            opacity="0"
			            ng-mouseenter="link.show=true"
			            ng-mouseleave="link.show=false"></line>
								<line class="link" 
									stroke-width="2" 
									ng-attr-x1="{{ link.source.x }}"
									ng-attr-y1="{{ link.source.y }}"
									ng-attr-x2="{{ link.target.x }}"
									ng-attr-y2="{{ link.target.y }}"></line>
							</g>
						</g>
						<g class="nodes">
							<g ng-repeat="node in graphNodes">
								<a xlink:href="{{ (node.first_name) ? '#/users/' + node.id : '#/topics/' + node.id }}">
									<circle class="node" 
										ng-attr-r="{{ node.radius }}" 
										ng-attr-fill="{{ (node.first_name) ? '#FFFF66' : '#00CC66' }}"
										ng-attr-cx="{{ node.x }}"
										ng-attr-cy="{{ node.y }}"></circle>
								</a>
								<text pointer-events="none"
									ng-attr-x="{{ node.x }}"
									ng-attr-y="{{ node.y }}"
									text-anchor="middle">{{ (node.first_name) ? node.first_name + ' ' + node.last_name : node.title }}</text>
							</g>
						</g>
					</g>
				</svg>
			</div>
		</script>

		<script src="/assets/angular.js"></script>
		<script src="/assets/angular-route.js"></script>
		<script src="/assets/jquery-1.11.0.js"></script>
    	<script src="/assets/ui-bootstrap-tpls-0.10.0.min.js "></script>
    	<script src="/assets/angular-local-storage.js "></script>
		<script src="/assets/underscore.js"></script>
		<script src="/assets/d3.v3.min.js"></script>
		<script src="/assets/dewey.js"></script>
		<script src="/assets/dewey.config.js"></script>
		<script src="/assets/dewey.service.js"></script>
		<script src="/assets/dewey.controllers.js"></script>
	</body>
</html>
