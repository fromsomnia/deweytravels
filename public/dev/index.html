<!doctype html>
<html>
	<head>

		<!-- allows responsive web design -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Dewey | Find the Right People </title>

		<!-- stylesheets -->
		<link rel="stylesheet" type="text/css" href="/assets/bootstrap.css"/>
		<link rel="stylesheet" type="text/css" href="/assets/dewey.css"/>
    <style>
      .link {
        stroke: #ffffff;
        stroke-opacity: .6;
      }
    </style>

	</head>
	<body data-ng-app="DeweyApp">
		<!-- container -->
    <div data-ng-view></div>

		<!-- logout template -->
		<script type="text/ng-template" id="/logout">
      <div id="main" class="container-fluid">
  			<div class="col-xs-12"> 
			    <div class="login col-xs-12">
			    	<img id="logo" class="col-xs-12" src="/assets/logo_transparent.png">
			    	<br>
			    	<span class="mission col-xs-12">explore company expertise</span>
			    	<br>
			    </div>
        </div>
      </div>
		</script>

		<!-- login template -->
		<script type="text/ng-template" id="/login">
      <div id="main" class="container-fluid">
  			<div class="col-xs-12"> 
			    <div class="login col-xs-12">
			    	<img id="logo" class="col-xs-12" src="/assets/logo_transparent.png">
			    	<br>
			    	<span class="mission col-xs-12">explore company expertise</span>

            <button ng-click="showSocialcastLogin()" class="btn btn-default btn-lg col-xs-12">
              signup with socialcast
            </button>

            <button ng-click="googleLogin()" class="btn btn-default btn-lg col-xs-12">
              signup with google
            </button>

            <button ng-click="showSocialcastLogin()" class="btn btn-default btn-lg col-xs-12">
              login
            </button>

            <div ng-show="showSocialcastForm">
			    	  <input type="email" class="form-control" id="email" name="email" placeholder="email" ng-model="loginData.email">
			    	  <input type="password" class="form-control" id="password" name="password" placeholder="password" ng-model="loginData.password">

			    	  <button type="button" class="col-xs-12 btn btn-default btn-lg" ng-click='login()'>login</button>
			    	  <div class="col-xs-1"></div>
            </div>

            <div ng-show="showGoogleForm">
			    	  <input type="email" class="form-control" id="email" name="email" placeholder="email" ng-model="loginData.email">

			    	  <input type="password" class="form-control" id="password" name="password" placeholder="password" ng-model="loginData.password">

			    	  <input type="text" class="form-control" id="first_name" name="first_name" placeholder="first name" ng-model="loginData.firstName">

			    	  <input type="text" class="form-control" id="last_name" name="last_name" placeholder="last name" ng-model="loginData.lastName">

			    	  <button type="button" class="col-xs-12 btn btn-default btn-lg" ng-click='login()'>signup with google</button>
			    	  <div class="col-xs-1"></div>
            </div>
			    </div>
        </div>
      </div>
		</script>

		<!-- search template -->
		<script type="text/ng-template" id="/search">
      <div id="main" class="container-fluid">
  			<div class="col-xs-12"> 
			    <div ng-include src="'/navigation'"></div>
			    <div ng-include src="'/list'"></div>
        </div>
      </div>
		</script>

		<!-- user template -->
		<script type="text/ng-template" id="/user">
      <div id="main" class="container-fluid">
  			<div class="col-xs-12"> 
  			  <div ng-include src="'/navigation'"></div>
  			  <div ng-include src="'/user_profile'"></div>
  			  <div ng-include src="'/tags'"></div>
        </div>
      </div>

  	  <div ng-include src="'/graph'"></div>
		</script>

		<!-- topic template -->
		<script type="text/ng-template" id="/topic">

      <div id="main" class="container-fluid">
  			<div class="col-xs-12"> 
			    <div ng-include src="'/navigation'"></div>
			    <div ng-include src="'/topic_profile'"></div>
			    <div ng-include src="'/list'"></div>
        </div>
      </div>

  	  <div ng-include src="'/graph'"></div>
		</script>

		<script type="text/ng-template" id="/">
		</script>
		<script type="text/ng-template" id="/">
		</script>
		<script type="text/ng-template" id="/">
		</script>
		<script type="text/ng-template" id="/">
		</script>

		<!-- navigation template -->
		<script type="text/ng-template" id="/navigation">
			<nav class="nav col-xs-12">
				<a href="#/search">
					<img id="logo" src="/assets/logo.png">
				</a>
				<div class="col-xs-10">
					<div class="col-xs-12 input-group input-group-lg">
					  <input id="search" type="text" class="form-control" placeholder="search by topic or person" ng-keyup="search()" ng-model="queryData.query">
					</div>
				</div>
			</nav>
		</script>

		<!-- list template -->
		<script type="text/ng-template" id="/list">
			<div class="list col-xs-12 list-group">
				<div ng-repeat="result in results" class="list-group-item">
				  <a href="#/{{ result.category }}/{{ result.id }}">
						<div class="circular-image" style="background-image:url('{{ result.image_url }}')"></div>
				  	<div class="col-xs-10 result-text-container">
					    <h4 class="list-group-item-heading">{{ result.name }}</h4>
					    <p class="list-group-item-text">{{ result.department }}</p>
				  	</div>
				  </a>
				  <div class="col-xs-2 pull-right">
            <span ng-click="removeUserFromTopic($event, result.id)" class="glyphicon glyphicon-remove"></span>
          </div>

				</div>
        <div ng-if="should_show_add_user_to_topic">
          <div class="list-group-item">
					  <div class="circular-image" style="background-image:url('/assets/plus.png')"></div>
					  <div class="col-xs-10 result-text-container">
              <input id="typeahead" type="text" class=" form-control" ng-model="selectedUser" placeholder="Add user" typeahead-on-select="addUserToTopic($item)" typeahead="user as user.first_name + user.last_name for user in user_choices | filter: $viewValue | limitTo: 8"  />
					  </div>
          </div>
        </div>
			</div>
		</script>

		<!-- user profile template -->
		<script type="text/ng-template" id="/user_profile">
			<div class="profile col-xs-12">
				<div class="circular-image" style="background-image:url('{{ user.image_url }} ')"></div>
				<div class="col-xs-12">
					<span class="name">{{ user.first_name }} {{ user.last_name }}</span>
					<br>
					<span class="description">{{ user.position }}</span>
					<br>
					<br>
					<span class="email">email: {{ user.email }}</span>
					<br>
					<span class="phone">phone: {{ user.phone }}</span>
				</div>
			</div>
		</script>

		<!-- topic profile template -->
		<script type="text/ng-template" id="/topic_profile">
			<div class="profile col-xs-12">
				<div class="circular-image" style="background-image:url('{{ topic.freebase_image_url }}')"></div>
				<div class="col-xs-12">
					<span class="name">{{ topic.title }}</span> 
					<br>
					<span class="description">{{ topic.description }}</span>
				</div>
			</div>
		</script>

		<!-- tags template -->
		<script type="text/ng-template" id="/tags">
			<div class="tags col-xs-12">
        <span class="tag" ng-repeat="tag in topics">
          <a href="#/topics/{{ tag.id }}">{{ tag.title }}</a>
          <span ng-click="removeTopicFromUser($event, tag.id)" class="glyphicon glyphicon-remove"></span>
        </span>
        <input id="typeahead" type="text"  ng-model="selectedTopic" placeholder="Add expertise" typeahead-on-select="addTopicToUser($item)" typeahead="topic as topic.title for topic in topic_choices | filter: $viewValue | limitTo: 8"  />
			</div>
		</script>

    <script type="text/ng-template" id="/graph">
		<!-- graph -->
    <div ng-controller="GraphController" style="margin-left: 500px">
      <svg ng-attr-width="{{width}}"
           ng-attr-height="{{height}}">
        <g ng-repeat="link in links">

		      <!-- bigger, hidden mouseover area -->
          <line
            class="link"
            ng-attr-stroke-width="{{link.strokeWidth + 25}}"
            ng-attr-x1="{{link.source.x}}"
            ng-attr-y1="{{link.source.y}}"
            ng-attr-x2="{{link.target.x}}"
            ng-attr-y2="{{link.target.y}}"
            position="absolute"
            opacity="0"
            ng-mouseenter="link.show=true"
            ng-mouseleave="link.show=false">
          </line>

          <line
            class="link"
            ng-attr-stroke-width="{{link.strokeWidth}}"
            ng-attr-x1="{{link.source.x}}"
            ng-attr-y1="{{link.source.y}}"
            ng-attr-x2="{{link.target.x}}"
            ng-attr-y2="{{link.target.y}}">
          </line>

          <foreignObject ng-if="link.connection"
             width="30"
             height="30"
             ng-attr-x="{{(link.source.x + link.target.x) / 2 - 50}}"
             ng-attr-y="{{(link.source.y + link.target.y) / 2 - 50}}">
           <div ng-hide="link.is_upvoted" ng-click="upvote(link);" class="glyphicon glyphicon-thumbs-up"></div>
           <div ng-hide="link.is_downvoted" ng-click="downvote(link);" class="glyphicon glyphicon-thumbs-down"></div>
          </foreignObject>
        </g>

        <g ng-repeat="node in nodes">
          <a ng-xlink:href="{{node.href}}" xlink:href="">
            <circle class="node"
              ng-attr-r="{{node.radius}}"
              ng-attr-fill="{{node.color}}"
              ng-attr-cx="{{node.x}}"
              ng-attr-cy="{{node.y}}">
            </circle>
          </a>
          <text ng-attr-x="{{node.x}}"
          	ng-attr-y="{{node.y}}"
          	text-anchor="middle"
          	pointer-events="none">{{node.name}}
          </text>
        </g>
      </svg>
    </div>
    </script>
		<!-- javascripts -->

		<script src="/assets/angular.js"></script>
		<script src="/assets/angular-route.js"></script>
		<script src="/assets/jquery-1.11.0.js"></script>
    <script src="/assets/ui-bootstrap-tpls-0.10.0.min.js "></script>
    <script src="/assets/angular-local-storage.js "></script>
    <script src="https://apis.google.com/js/client.js?onload=OnLoadCallback"></script>
		<script src="/assets/underscore.js"></script>
		<script src="/assets/d3.v3.min.js"></script>
		<script src="/assets/dewey.js"></script>
		<script>
			// instantiate Dewey Angular app
			var DeweyApp = Dewey();
		</script>
	</body>
</html>
