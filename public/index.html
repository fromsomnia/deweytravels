<!doctype html>
<html>
	<head>

		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta property="og:image" content="http://www.deweytravels.com/assets/logo.png" />
		<meta property="og:title" content="Dewey" />
		<meta property="og:description" content="Explore where your friends have traveled!" />

		<title>Dewey | Explore Where Your Friends Have Been </title>

		<link rel="stylesheet" type="text/css" href="/assets/bootstrap.css"/>
		<link rel="stylesheet" type="text/css" href="/assets/dewey.css"/>

		<script src="/assets/jquery-1.11.0.js"></script>
    <!-- start Mixpanel -->

    <script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
    for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);

   </script>


    <!-- end Mixpanel -->
	</head>

	<body data-ng-app="DeweyApp">
		<div id="fb-root"></div>

		<!-- required for facebook login -->
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=1387319571552620";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>

		<!-- required for facebook share button -->
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=1387319571552620&version=v2.0";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>

		<!-- container; updates with angular routes -->
		<div data-ng-view></div>

		<!-- logout template -->
		<script type="text/ng-template" id="/logout">
			<div id="main-view">
				<div id="top-bar"></div>
				<div id="left-bar">
	  			<div class="col-xs-12"> 
				    <div class="login col-xs-12">
				    	<img id="logo" class="col-xs-12" src="/assets/logo_transparent.png">
				    	<br>
				    	<span class="mission col-xs-12">explore where your friends have been</span>
				    	<br>
				    </div>
	        </div>
				</div>
				<div id="data-viz"></div>
		</script>

    <script type="text/ng-template" id="/facebookLoginButton">
      <div>
        <button ng-show="facebookLoginButton" ng-click="facebookLogin()" class="btn btn-default btn-lg col-xs-12">
        	Signup with Facebook
        </button>
      </div>
    </script>

		<script type="text/ng-template" id="/login">
			<div id="main-view">
				<div id="top-bar"></div>
				<div id="left-bar">
					<div id="login" class="col-xs-12">
						<img id="logo" class="col-xs-12" src="/assets/logo_transparent.png">
						<br>
			    	<span class="mission col-xs-12">explore where your friends have been</span>
            <button ng-show="facebookLoginButton" ng-click="facebookLogin()" class="btn btn-default btn-lg col-xs-12">
            	login with facebook
            </button>
					</div>
				</div>
				<div id="data-viz"></div>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/search">
			<div id="main-view">
				<div id="top-bar"></div>
				<div id="left-bar">
					<div id="search">
						<div ng-include src="'/navigation'"></div>
						<div ng-include src="'/searchResults'"></div>
					</div>
				</div>
				<div id="data-viz"></div>
			</div>
		</script>

		<script type="text/ng-template" id="/navigation">
			<nav id="nav" class="col-xs-12">
				<a ng-attr-href="#/users/{{ currentUserId }}">
					<img id="logo" src="/assets/logo.png">
				</a>
				<div id="search" class="input-group input-group-lg">
				  <input type="text" class="form-control" placeholder="search for person or place" ng-keyup="search()" ng-model="queryData.query">
				</div>
			</nav>
		</script>

		<script type="text/ng-template" id="/searchResults">
			<div id="list" class="col-xs-12 list-group">
				<div ng-repeat="result in searchResults | limitTo: 8" class="list-group-item">
				  <a href="#/{{ result.category }}/{{ result.id }}">
						<div class="circular-image" style="background-image:url('{{ result.image_url }}')"></div>
				  	<div class="result-text-container">
					    <h4 class="list-group-item-heading">{{ result.name }}</h4>
					    <p class="list-group-item-text">{{ result.description }}</p>
				  	</div>
				  </a>
				</div>
			</div>
		</script>
		<script type="text/ng-template" id="/navbarbuttons">
		<button ng-click="facebookLogout()" class="btn btn-default btn-dewey">
			log out
		</button>
		<button ng-click="facebookShare()" class="btn btn-default btn-dewey">
			share on fb
		</button>
		</script>
		<script type="text/ng-template" id="/user">
			<div id="main-view">
				<div id="top-bar"><div ng-include src="'/navbarbuttons'"></div>
				</div>
				<div id="left-bar">
					<div ng-include src="'/navigation'"></div>
					<div ng-include src="'/userProfile'"></div>
					<div ng-include src="'/topicsForUser'"></div>

          <div ng-hide="isLoggedIn" ng-include src="'/callToSignupInUser'"></div>
				</div>
				<div id="data-viz">
					<div ng-include src="'/graph'"></div>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/userProfile">
			<div id="profile" class="col-xs-12">
				<div id="information">
					<div class="circular-image" style="background-image:url('{{ user.image_url }}')"></div>
					<h4 class="name">{{ user.first_name }} {{ user.last_name }}</h4>
					<button ng-show="isLoggedIn" ng-click="sendFacebookMessage()" class="btn btn-default btn-med">message via fb</button>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/topicsForUser">
			<div id="tags" class="col-xs-12">
        <input ng-show="isLoggedIn" id="typeahead" type="text"  ng-model="selectedTopic" placeholder="add a place to profile" typeahead-on-select="addTopicToUser($item)" typeahead="topic as topic.title for topic in topicChoices | filter: $viewValue | limitTo: 8"/>
				<div ng-show="topicsForUser && isLoggedIn">
	        <h4 ng-show="currentUserId == user.id">Places you've been to:</h4>
	        <h4 ng-show="currentUserId != user.id">Places {{user.first_name}}'s been to:</h4>
	        <span class="tag" ng-repeat="topic in topicsForUser">
	          <a href="#/topics/{{ topic.id }}">{{ topic.title }}</a>
	          <span ng-click="removeTopicFromUser(topic.id)" class="glyphicon glyphicon-remove"></span>
	        </span>
	      </div>
				<div ng-show="isLoggedIn">
	        <h4 ng-show="currentUserId == user.id">Have you been to the following places?</h4>
	        <h4 ng-show="currentUserId != user.id">Has {{user.first_name}} been to the following places?</h4>
	        <span class="tag" ng-repeat="topic in topicSuggestions">
	          <a href="#/topics/{{ topic.id }}">{{ topic.title }}</a>
	          <span ng-click="addTopicSuggestionToUser(topic, $topic)" class="glyphicon glyphicon-check"></span>
	        </span>
          <span ng-click="shuffleTopicSuggestionsToUser()" class="tag">Shuffle Suggestions</span>
				</div>
			</div>
		</script>

		<script type="text/ng-template" id="/topic">
			<div id="main-view">
				<div id="top-bar"><div ng-include src="'/navbarbuttons'"></div></div>
				<div id="left-bar">
					<div ng-include src="'/navigation'"></div>
					<div ng-include src="'/topicProfile'"></div>


					<div ng-show="isLoggedIn" ng-include src="'/usersForTopic'"></div>

					<div ng-show="isLoggedIn" ng-include src="'/topicsForTopic'"></div>

					<div ng-include src="'/addDestinationInTopic'"></div>
          <div ng-hide="isLoggedIn" ng-include src="'/callToSignupInTopic'"></div>
				</div>
				<div id="data-viz">
					<div ng-include src="'/graph'"></div>
				</div>
			</div>
		</script>

    
    <script type="text/ng-template" id="/callToSignupInUser">
      <div class="signup-call" ng-controller="BaseLoginController">
        <div class="signup-call-header">
          <h3><a href="#" ng-click="facebookLogin()">Signup with Facebook</a></h3>
        </div>
        <div class="signup-call-body">
          {{ user.name }} has been to 30 places.
          <b><a href="#" ng-click="facebookLogin()">
          	Signup with Facebook to see where your friends have been.
          </a></b>
        </div>
      </div>
    </script>

    <script type="text/ng-template" id="/callToSignupInTopic">
      <div class="signup-call-header" ng-controller="BaseLoginController">
        <h3><a href="#" ng-click="facebookLogin()">Signup with Facebook</a></h3>
      </div>
      <div class="signup-call-body">
        30 people on Dewey have been to {{ topic.title }}. 
        <b><a href="#" ng-click="facebookLogin()">
        	Signup with Facebook to see where your friends have been.
        </a></b>
      </div>
    </script>
		<script type="text/ng-template" id="/topicProfile">
			<div id="profile" class="col-xs-12">
				<div id="information">
					<div class="circular-image" style="background-image:url('{{ topic.image_url }}')"></div>
			  	<div class="text-container">
				    <h4 class="">{{ topic.title }}</h4>
			  	</div>
					<span class="description">{{ topic.description }}</span>
			  	<div ng-show="isLoggedIn && !isUserAnExpert" class="text-container">
            <span><a href="" ng-click="addSelfToTopic()">I have been here<span  class="glyphicon glyphicon-check"></span></a></span>
          </div>
				</div>
				<br>
			</div>
		</script>

		<script type="text/ng-template" id="/usersForTopic">
			<div id="list" class="col-xs-12 list-group">
				<h4>People who've been here</h4>
				<div ng-repeat="user in usersForTopic" class="list-group-item">
				  <a href="#/users/{{ user.id }}">
						<div class="circular-image" style="background-image:url('{{ user.image_url }}')"></div>
				  	<div class="user-text-container">
					    <h4 class="list-group-item-heading">{{ user.name }}</h4>
				  	</div>
				  </a>
				  <div class="col-xs-2" style="position: absolute; right: 10px;top: 20px;">
            <span ng-click="removeUserFromTopic(user.id)" class="glyphicon glyphicon-remove"></span>
          </div>
				</div>
      </div>
    </script>

    <script type="text/ng-template" id="/userSuggestionsForTopic">
			<div id="list" class="col-xs-12 list-group">
        <h4>Have Your Friends Been to {{ topic.title }}?</h4>
				<div ng-repeat="user in userSuggestions" class="list-group-item">
				  <a href="#/users/{{ user.id }}">
						<div class="circular-image" style="background-image:url('{{ user.image_url }}')"></div>
				  	<div class="user-text-container">
					    <h4 class="list-group-item-heading">{{ user.first_name }} {{ user.last_name }}</h4>
				  	</div>
				  </a>
				  <div class="col-xs-2" style="position: absolute; right: 10px;top: 20px;">
            <span ng-click="addUserSuggestionToTopic(user, $index)" class="glyphicon glyphicon-check"></span>
          </div>
        </div>
        <div ng-if="shouldShowAddUserToTopic">
          <div class="list-group-item">
					  <div class="circular-image" style="background-image:url('/assets/plus.png')"></div>
					  <div class="result-text-container">
              <input id="typeahead" type="text" class=" form-control" ng-model="selectedUser" placeholder="Add user" typeahead-on-select="addUserToTopic($item)" typeahead="user as user.name for user in userChoices | filter: {name: $viewValue} | limitTo: 8" style="width:140px"/>
					  </div>
          </div>
        </div>

				<br>
			</div>
		</script>

    <script type="text/ng-template" id="/addDestinationInTopic">
			<div id="list" class="col-xs-12 list-group">
	      <h4>Add a Destination in  {{ topic.title }}?</h4>
		  	<div class="list-group-item">
		  		<div class="circular-image" style="background-image:url('/assets/plus.png')"></div>
		  		<div class=" result-text-container">
		  			<input id="new-topic" type="text" class="form-control" placeholder="Add a destination" ng-keyup="addSubtopicToTopic()" ng-model="newTopic.title" style="width:140px" />
		  		</div>
		  		</div>
		  	</div>
		  </div>
    </script>

		<script type="text/ng-template" id="/topicsForTopic">
			<div id="list" class="col-xs-12 list-group">
				<h4 ng-show="isLoggedIn">Similar places</h4>
				<div ng-repeat="topic in topicsForTopic | limitTo: 5" class="list-group-item">
				  <a href="#/topics/{{ topic.id }}">
						<div class="circular-image" style="background-image:url('{{ topic.image_url }}')"></div>
				  	<div class="user-text-container">
					    <h4 class="list-group-item-content">{{ topic.title }}</h4>
				  	</div>
				  </a>
				</div>
        <br>
			</div>
		</script>

		<!-- visualization template -->
		<script type="text/ng-template" id="/graph">
			<div ng-controller="GraphController">
				<svg>
					<g class="graph-container" ng-repeat="cluster in clusters">
						<g class="cluster">
							<g class="primary" ng-attr-transform="{{ 'translate(' + cluster.primaryNode.x + ',' + cluster.primaryNode.y + ')'}}">
								<circle ng-attr-r="{{ cluster.primaryNode.radius }}" ng-attr-fill="{{ (cluster.primaryNode.category === 'user' ) ? '#1d9f7f' : '#25a0ca' }}" stroke="#ffffbf" stroke-width="5" ng-click="focusOnCluster($index)" ng-attr-style="cursor:{{ (cluster.primaryNode.category === 'user' ) ? 'default' : 'pointer' }}"></circle>
								<a xlink:href="{{ (cluster.primaryNode.first_name) ? '#/users/' + cluster.primaryNode.id : '#/topics/' + cluster.primaryNode.id }}">
									<text dy="0.35em" style="font-size:1.2em" text-anchor="middle">{{ (cluster.primaryNode.first_name) ? cluster.primaryNode.first_name + ' ' + cluster.primaryNode.last_name : cluster.primaryNode.title }}</text>
								</a>
							</g>
							<g class="outer" ng-repeat="node in cluster.outerNodes" ng-attr-transform="{{ 'translate(' + node.x + ',' + node.y + ')' }}">
								<circle ng-attr-r="{{ node.radius }}" ng-attr-fill="{{ (node.category === 'user' ) ? '#1d9f7f' : '#25a0ca' }}" ng-click="expandNode(node)" ng-attr-style="cursor:{{ (node.category === 'user' ) ? 'default' : 'pointer' }}"></circle>
								<a xlink:href="{{ (node.first_name) ? '#/users/' + node.id : '#/topics/' + node.id }}">
									<text dy="0.35em" style="font-size:0.7em" text-anchor="middle">{{ (node.first_name) ? node.first_name + ' ' + node.last_name : node.title }}</text>
								</a>
							</g>
						</g>
					</g>
				</svg>
			</div>
		</script>

		<script src="/assets/angular.js"></script>
		<script src="/assets/angulartics.js"></script>
		<script src="/assets/angulartics-mixpanel.js"></script>
		<script src="/assets/angular-route.js"></script>

    <script src="/assets/ui-bootstrap-tpls-0.10.0.min.js "></script>
    <script src="/assets/angular-local-storage.js "></script>
		<script src="/assets/underscore.js"></script>
		<script src="/assets/d3.v3.min.js"></script>


		<!-- Angular javascript -->
		<script src="/assets/dewey.js"></script>
		<script src="/assets/dewey.config.js"></script>
		<script src="/assets/dewey.service.js"></script>
		<script src="/assets/dewey.controllers.js"></script>






	</body>
</html>
